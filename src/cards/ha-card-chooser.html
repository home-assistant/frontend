<link rel='import' href='../../bower_components/polymer/polymer.html'>

<link rel='import' href='./ha-camera-card.html'>
<link rel='import' href='./ha-entities-card.html'>
<link rel='import' href='./ha-introduction-card.html'>
<link rel='import' href='./ha-media_player-card.html'>
<link rel='import' href='./ha-weather-card.html'>
<link rel='import' href='./ha-persistent_notification-card.html'>

<script>
Polymer({
  is: 'ha-card-chooser',

  properties: {
    cardData: {
      type: Object,
      observer: 'cardDataChanged',
    },
  },

  _ensureCustomUILoaded: function (stateType) {
    this.importHref(
        '/local/custom_ui/state-card-' + stateType + '.html',
        function () {},
        /* eslint-disable no-console */
        function () { console.error('Error loading %s from /local/custom_ui/state-card-%s.html', stateType, stateType); },
        /* eslint-enable no-console */
        true);
  },

  cardDataChanged: function (newData) {
    if (!newData) return;

	var cardType = '';

    if (newData.stateObj && newData.stateObj.attributes && 'custom_ui_state_card' in newData.stateObj.attributes) {
      cardType = newData.stateObj.attributes.custom_ui_state_card;
      this._ensureCustomUILoaded(cardType);
      cardType = 'STATE-CARD-' + cardType.toUpperCase();
    } else {
      cardType = 'HA-' + newData.cardType.toUpperCase() + '-CARD';
    }
    window.hassUtil.dynamicContentUpdater(this, cardType, newData);
  },
});
</script>
