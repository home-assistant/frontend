<link rel="import" href="../../../bower_components/polymer/polymer-element.html">
<link rel="import" href="../../../bower_components/paper-card/paper-card.html">
<link rel="import" href="../../../bower_components/paper-item/paper-item.html">
<link rel="import" href="../../../bower_components/paper-item/paper-item-body.html">
<link rel="import" href="../../../bower_components/iron-icon/iron-icon.html">

<link rel='import' href='../../../src/util/hass-mixins.html'>

<dom-module id="ha-config-navigation">
  <template>
    <style include="iron-flex">
      paper-card {
        display: block;
      }
      paper-item {
        cursor: pointer;
      }
    </style>
    <paper-card>
      <template is='dom-repeat' items='[[pages]]'>
        <template is='dom-if' if='[[_computeLoaded(hass, item)]]'>
          <paper-item on-tap='_navigate'>
            <paper-item-body two-line>
              [[_computeCaption(item, localize)]]
              <div secondary>[[_computeDescription(item, localize)]]</div>
            </paper-item-body>
            <iron-icon icon='mdi:chevron-right'></iron-icon>
          </paper-item>
        </template>
      </template>
    </paper-card>
  </template>
</dom-module>

<script>
/*
 * @appliesMixin window.hassMixins.LocalizeMixin
 * @appliesMixin window.hassMixins.EventsMixin
 */
class HaConfigNavigation extends
  window.hassMixins.LocalizeMixin(window.hassMixins.EventsMixin(Polymer.Element)) {
  static get is() { return 'ha-config-navigation'; }

  static get properties() {
    return {
      hass: {
        type: Object,
      },

      pages: {
        type: Array,
        value: [
          {
            domain: 'core',
            loaded: true,
          },
          {
            domain: 'customize',
            loaded: true,
          },
          {
            domain: 'automation',
          },
          {
            domain: 'script',
          },
          {
            domain: 'zwave',
          }
        ],
      }
    };
  }

  _computeLoaded(hass, component) {
    return component.loaded || window.hassUtil.isComponentLoaded(hass, component.domain);
  }

  _computeCaption(component, localize) {
    return localize(`ui.panel.config.${component.domain}.caption`);
  }

  _computeDescription(component, localize) {
    return localize(`ui.panel.config.${component.domain}.description`);
  }

  _navigate(ev) {
    history.pushState(null, null, '/config/' + ev.model.item.domain);
    this.fire('location-changed');
  }
}

customElements.define(HaConfigNavigation.is, HaConfigNavigation);
</script>
